# Weather App

Данный проект был выполнен в рамках тестового задания на позицию iOS-разработчика в команду VK Маркета. 
Weather App приложение которое позволяет получать актуальный прогноз погоды на ближайшие 5 дней на основании своей геопозиции, а так же вводя интересующий город в строку поиска.
<a href="https://developer.apple.com/swift" target="_blank"><img src="https://img.shields.io/badge/Language-Swift_5-blueviolet.svg" alt="Language: Swift 5" /></a>

___
### UIKit / MVP+Router / CLLocation / NSCache / URLSession / Auto Layout Programmatically / OpenWeatherMap API /без использования сторонних библиотек.
___

### Prerequisites

The following are the versions used when compiling this program:

Targeted iOS: 15.0 iPhone

Device Orientation: Portrait

## Weather App

Приложение написано на архитектуре MVP + Router. Данная архитектура позволяет писать модульный и хорошо тестируемый код, который в последствии легко поддерживать, расширять и модифицировать. 


### Example Run

* Weather app стартовая страница.
На стартовом экране отображается текущая погода и на ближайшие 5 дней в виде таблицы UITableView на основании геоданных полученных от устройства.  
<img src="https://github.com/InnaStepanova/Weather/assets/69930650/f7c8cc92-7f66-498f-bc8a-9724f7d01e20)" width="300">

* Weather app экран поиска.
На данной экране установлена строка поиска. Пользовталь вносит название города - в случае введения корректного названия будет открыт экран с детальной информацией о погоде в данном городе на текущий момент и на ближайшие 5 дней в виде таблицы UITableView. В случае не корректного ввода пользователь увидет оповещение о том что название города было введено не верно, строка поиска при этом будет очищена. 
<img src="https://github.com/InnaStepanova/Weather/assets/69930650/c9aac90e-de84-47b8-841e-9119c352414d)" width="300">


### Функциональные особенности
* Работа с JSON - Рекомендованый в тестовом задании OpenWeatherMap API в своей бесплатной версии может предоставить набор данных о погоде по заданному местоположению на ближайшие 5! дней с интервалом в 3 часа. К сожалению без оплаты полной версии по лучить прогноз погоды на ближайшие 7 дней не предоставилось возможным. 

* Работа по форматированию даты. Из JSON дата приходиит в формате TimeInterval, который отдельно форматировался для понятного отображения в интерфейсе приложения. Так же было много работы с тем чтобы собирать информацию относящуюся к одному дню - тк API предоставляет прогнозируемые данные в определенном временном отрезке, но не дает информации о максимальной и минимальной температуре на конкретную дату - это пришлось высчитывать отдельно для отображения в интерфейсе

* Локализация пользователя определялась с использованием CoreLocation и CLGeokoder - который определял город на основании текущих координат пользователя.
<img src="https://github.com/InnaStepanova/Weather/assets/69930650/b378026a-4e90-4af3-9ea8-1ea020ac3c9f)" width="300">

* В проекте предусмотрено кэширование данных в классе CacheManager. Для хранения данных используется NSCache. Выбор NSCache обусловлен тем, что полученные из сети данные быстро устаревают, поэтому нет необходимости хранить их в более масштабных хранилищах, таких как например CoreData.    

* Реализована следующая логика работы с CacheManager - прежде чем отправить запрос в сеть для требуемого города, будет опрошено хранилище кэша. Если по данному запросу будут найдены данные - будет произведена проверка когда эти данные были получены - если данные были получены меньше суток назад, то считаем что они валидны их можно показать пользователю без похода в сеть. При этом будет произведена сортировка данных и пользователю будет показан прогноз на ближайшее время (т.е. те данные которые по времени ближе всего к текущему (прогноз как мы помним нам приходит с интервалом в 3 часа)). Если данные есть, но прошло уже более суток с момента их получения идем в сеть за новыми, и обновляем кэш.

### Возникшие проблемы во время разрботки. 
* Хотелось реализовать проверку введенных пользователем данных на соответствие названию города. Те если пользователь ввел текст не относящийся к названию города, то мы узнаем об этом заранее и не отправляем запрос в сеть. Для данной проверки я хотела использовать MKLocalSearch, но либо у меня руки кривые, либо я его как то не правильно использовала, т.к. на практически любой запрос MKLocalSearch возвращал найденное местоположение(. Пришлось место него все таки каждый раз ходить в сеть и дожидаться ответа от сервера - в случае неудачи - экран с детальной информацией не открывается, а пользователю всплывает подсказка с предложением ввести корректное название.
<img src="https://github.com/InnaStepanova/Weather/assets/69930650/adeaf1fa-e4fe-4bf3-b68c-65727218d922)" width="300">
* То что возвращал MKLocalSearch
<img width="565" alt="5" src="https://github.com/InnaStepanova/Weather/assets/69930650/cfd09db5-7fe1-416b-a711-dd0a19e8dfd3">

* 
